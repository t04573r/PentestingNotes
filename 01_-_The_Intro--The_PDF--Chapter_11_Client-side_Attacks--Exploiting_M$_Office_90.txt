#### Exploiting M$ Office



						Malicious Microsoft Office Macros are used in most ransomware attacks to gain an initial 
						foothold. 
						Several deterrences are in place against this. One is the training of employees in the dangers of 
						opening attachments or enabling macros.
						If a MS Office doc is downloaded, it will tagged with the Mark Of The Web. Documents tagged 
						with MOTW will open up in Protected View when downloaded onto NTFS devices.
						One method of encouragement is to blur the document, prompting the target to “unlock” it by 
						disabling protected view.
						MS Publisher allows macros but does not use protected view protection.
						 
					 	Despite the stringent security controls against malicious macros, attackers are still able to 
						leverage the use of macros more often than not. Penetration testers should never be 
						discouraged by the introduction of new defensive mechanisms, rather these novel defenses
						should be viewed as an opportunity to create more sophisticaed attacks.
						
						Macros can be written in VBA. This gives them full access to ActiveX objects. Macros can also
						be written in Windows Script Host, similiar to JavaScript.
						
						By declaring a base64-encoded PowerShell download cradle as a String in VBA, we can obtain 
						remote code execution.
						
						Declare Str using Dim

