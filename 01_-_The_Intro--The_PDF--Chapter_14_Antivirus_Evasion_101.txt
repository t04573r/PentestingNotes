### Chapter 14: Antivirus Evasion






AV typically includes IDS, IPS, firewall, website scanners and more.

EDR Endpoint detection response forwards security events to a SIEM, security information and event management system, which collects data from every company host.


Different AV engines include: 

    File Engine
    Memory Engine
    Network Engine
    Disassembler
    Emulator/Sandbox
    Browser Plugin
    Machine Learning Engine

Detection methods include:

    Signature-based Detection
    Heuristic-based Detection
    Behavioral Detection
    Machine Learning Detection

Evasion Techniques:

Packers (obsolete)

Obfuscators

Crypters

Anti-reversing

Anti-debugging

Virtual Machine Emulation Detection

Anti-copy

The Enigma Protector

Shellter

In-Memory
	- Remote Process Memory Injection
	OpenProcess4 function to obtain a valid HANDLE5 to a target process that we have permission to access. 
	allocate memory in the context of that process by calling a Windows API such as VirtualAllocEx.6 
	 copy the malicious payload to the newly allocated memory using WriteProcessMemory.  execute in memory in a separate thread using the CreateRemoteThread8 API.
	
	- Reflective DLL Injection 
		Requires a custom API that doesn't rely on disk based DLL.
		
- Process Hollwing
- Inline hooking 
   â†’ rootkits
sudo apt install shellter


