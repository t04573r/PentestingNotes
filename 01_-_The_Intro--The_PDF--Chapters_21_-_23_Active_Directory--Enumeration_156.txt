#### Enumeration


  Powershell Script to Enumerate DC:
  
	  # Store the domain object in the $domainObj variable
	$domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()

	# Store the PdcRoleOwner name to the $PDC variable
	$PDC = $domainObj.PdcRoleOwner.Name

	# Store the Distinguished Name variable into the $DN variable
	$DN = ([adsi]'').distinguishedName

	# Print the $DN variable
	$DN
	
Powershell Module to Search DC:

>write the following to file called function.ps1
	
					function LDAPSearch {
					param (
						[string]$LDAPQuery
					)

					$PDC = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner.Name
					$DistinguishedName = ([adsi]'').distinguishedName

					$DirectoryEntry = New-Object System.DirectoryServices.DirectoryEntry("LDAP://$PDC/$DistinguishedName")

					$DirectorySearcher = New-Object System.DirectoryServices.DirectorySearcher($DirectoryEntry, $LDAPQuery)

					return $DirectorySearcher.FindAll()

				}
	
 PS C:\> Import-Module .\function.ps1
 
 PS C:\> LDAPSearch -LDAPQuery "(samAccountType=805306368)"
or
 PS C:\> LDAPSearch -LDAPQuery "(name=jeff)"
 
 
 Enumerate Service Principal Names
 
 C:\PowerTools> setspn -L iis_service
 PS > Get-NetUser -SPN | select samaccountname,serviceprincipalname
 C:\PowerTools> nslookup.exe web04.corp.com
 
 
 Next, move onto PowerView (PowerSploit), then SharpHound and Finally BloodHound. 
 
 

