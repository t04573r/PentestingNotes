#### Capstone: Reverse Shell Via XSS
Reverse Shell via XSS was possible on the machine.

nmap -sV results:
{screenshot: nmap}

An http server was detected operating via port 80.
Navigating to the IP address revealed the following page:
{screenshot firefox}

Inspection of headers reveals a vulnerable header:

{screenshot: Inspector, headers}

Inject a XSS payload into the User-Agent header. The payload will grab a nonce and set up a new admin account.

{screenshot: sending payload}

Next, we install a plugin that embeds a web PHP shell:

The web shell we are going to use is artyuum's simple php web shell.

We upload the shell as a plugin and navigate to

.../wp-admin/admin.php?page=Plugin%20Name/web-shell.php

{screenshot: webshell}

Great! now we can communicate with the server.

http://path/to/your/wordpress/site/wp-content/plugins/mylovelywebshell/mylovelywebshell.php

FURTHER ESCALATION:

upgrade the shell
find an exploitable vulnerability
get a root shell



